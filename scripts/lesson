#!/usr/bin/env python

'''Lesson management script.'''

import sys


def main(argv):
    '''Main command driver.'''
    require(len(argv) > 1)
    cmd, args = argv[1], argv[2:]
    require(cmd in COMMANDS, 'Unknown command: "{0}"'.format(cmd))
    COMMANDS[cmd](*args)


def _help():
    '''help: display help.'''
    print USAGE


def files(lesson, root_dir=None):
    '''files <lesson_name> [<install_directory>]: make local copy of files for lesson.'''
    if root_dir is None:
        root_dir = os.curdir
    print 'Copying files for "{0}" to "{1}".'.format(lesson, root_dir)


def view(lesson):
    '''view <lesson>: open lesson in browser.'''
    print 'Displaying "{0}" in browser.'.format(lesson)


def require(condition, *messages):
    '''Check and fail.'''
    if not condition:
        for m in messages:
            print >> sys.stderr, m
        print >> sys.stderr, USAGE
        sys.exit(1)


COMMANDS = {
    'help'  : _help,
    'view'  : view,
    'files' : files
}


USAGE = '''Usage: lesson command [args]
{0}
See https://github.com/gvwilson/lesson-installer-demo for more documentation.'''\
.format('\n'.join('  {:8}: {}'.format(c, COMMANDS[c].__doc__) for c in COMMANDS))


if __name__ == '__main__':
    main(sys.argv)
